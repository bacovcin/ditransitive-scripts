scale_y_continuous(name="% simulation p-values higher than empirical p-value",labels=c("0%","25%","50%","75%","100%"))+
scale_x_continuous(name="Absolute value difference between theme--recipient and recipient--theme slopes")
dev.off()
pdf('ditransgraph.pdf',width=12,height=4)
ggplot(subset(pred,variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))
dev.off()
pdf('ditransgraph.pdf',width=12,height=4)
ggplot(subset(pred,variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))
dev.off()
pdf('ditransgraph.pdf',width=12,height=4)
ggplot(subset(pred,variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))
dev.off()
summary(pred)
pred<-expand.grid(x=seq(-3,2,.01),Envir=c(levels(mreal$Envir)[1],levels(mreal$Envir)[2]))
pred.rt<-subset(pred,Envir==levels(mreal$Envir)[2])
pred.rt$postma_fit_full<-coef(postma_fit_full)[5]/(2+2*cosh(coef(postma_fit_full)[3]+coef(postma_fit_full)[4]*pred.rt$x))
pred.rt$prob_fit_full<-(1/(1+exp(-((coef(prob_fit_full)[3]+coef(prob_fit_full)[5]*pred.rt$x)))))*
(1/(1+exp(-((coef(prob_fit_full)[4]-coef(prob_fit_full)[6]*pred.rt$x)))))
pred.rt$prob_fit_downdiff<-(1/(1+exp(-((coef(prob_fit_downdiff)[3]+coef(prob_fit_downdiff)[2]*pred.rt$x)))))*
(1/(1+exp(-((coef(prob_fit_downdiff)[4]-coef(prob_fit_downdiff)[5]*pred.rt$x)))))
pred.tr<-subset(pred,Envir==levels(mreal$Envir)[1])
pred.tr$postma_fit_full<-1/(1+exp(-(coef(postma_fit_full)[1]+coef(postma_fit_full)[2]*pred.rt$x)))
pred.tr$prob_fit_full<-(1/(1+exp(-((coef(prob_fit_full)[1]+coef(prob_fit_full)[2]*pred.rt$x)))))
pred.tr$prob_fit_downdiff<-(1/(1+exp(-((coef(prob_fit_downdiff)[1]+coef(prob_fit_downdiff)[2]*pred.rt$x)))))
pred<-melt(as.data.frame(rbind(pred.rt,pred.tr)),id=c('x','Envir'))
points$size<-cut(points$num,breaks=c(-1,49,100),labels=c('Less than 50','50 or more'))
pdf('ditransgraph.pdf',width=12,height=4)
ggplot(subset(pred,variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))
dev.off()
library(reshape2)
pred<-expand.grid(x=seq(-3,2,.01),Envir=c(levels(mreal$Envir)[1],levels(mreal$Envir)[2]))
pred.rt<-subset(pred,Envir==levels(mreal$Envir)[2])
pred.rt$postma_fit_full<-coef(postma_fit_full)[5]/(2+2*cosh(coef(postma_fit_full)[3]+coef(postma_fit_full)[4]*pred.rt$x))
pred.rt$prob_fit_full<-(1/(1+exp(-((coef(prob_fit_full)[3]+coef(prob_fit_full)[5]*pred.rt$x)))))*
(1/(1+exp(-((coef(prob_fit_full)[4]-coef(prob_fit_full)[6]*pred.rt$x)))))
pred.rt$prob_fit_downdiff<-(1/(1+exp(-((coef(prob_fit_downdiff)[3]+coef(prob_fit_downdiff)[2]*pred.rt$x)))))*
(1/(1+exp(-((coef(prob_fit_downdiff)[4]-coef(prob_fit_downdiff)[5]*pred.rt$x)))))
pred.tr<-subset(pred,Envir==levels(mreal$Envir)[1])
pred.tr$postma_fit_full<-1/(1+exp(-(coef(postma_fit_full)[1]+coef(postma_fit_full)[2]*pred.rt$x)))
pred.tr$prob_fit_full<-(1/(1+exp(-((coef(prob_fit_full)[1]+coef(prob_fit_full)[2]*pred.rt$x)))))
pred.tr$prob_fit_downdiff<-(1/(1+exp(-((coef(prob_fit_downdiff)[1]+coef(prob_fit_downdiff)[2]*pred.rt$x)))))
pred<-melt(as.data.frame(rbind(pred.rt,pred.tr)),id=c('x','Envir'))
points$size<-cut(points$num,breaks=c(-1,49,100),labels=c('Less than 50','50 or more'))
pdf('ditransgraph.pdf',width=12,height=4)
ggplot(subset(pred,variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))
dev.off()
pdf('ditransgraph.pdf',width=12,height=4)
ggplot(subset(pred,variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
dev.off()
pdf('ditransgraph.pdf',width=12,height=4)
ggplot(subset(pred,variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
dev.off()
summary(mreal)
ggplot(mreal,aes((YoC,isTo))+
stat_smooth(method='loess',aes(colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
ggplot(mreal,aes(YoC,isTo))+
stat_smooth(method='loess',aes(colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
summary(mreal)
summary(mreal$YoC)
ggplot(mreal,aes(YoC,isTo))+
stat_smooth(method='loess',aes(colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(700,2100,200),labels=seq(800,2000,200))
ggplot(mreal,aes(YoC,isTo))+
stat_smooth(method='loess',aes(colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
coord_cartesian(xlim=c(750,2050))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
summary(points)
points$size<-cut(points$num,breaks=c(-1,49.5,100),labels=c('Less than 50','50 or more'))
summary(points)
points$size<-cut(points$num,breaks=c(-1,49.5,1000),labels=c('Less than 50','50 or more'))
summary(points)
ggplot(mreal,aes(YoC,isTo))+
stat_smooth(method='loess',aes(colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
coord_cartesian(xlim=c(750,2050))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
summary(rtreal$Eras)
summary(levels(rtreal$Eras))
levels(factor(rtreal$Eras))
summary(rtreal$YoC[rtreal$Eras==1725])
summary(rtreal$YoC[rtreal$Eras==1775])
summary(rtreal$YoC[rtreal$Eras==1625])
(1701+1825)/2
rtreal$Eras[rtreal$Eras>1700&rtreal$Eras<=1825]<-1763
(1912+1826)/2
rtreal$Eras[rtreal$Eras>1825]<-1869
rtreal$Eras[rtreal$Eras>1700&rtreal$Eras<=1825]<-1763
rtreal$Eras[rtreal$Eras>1825]<-1869
trreal$Eras[trreal$Eras>1700&trreal$Eras<=1825]<-1763
trreal$Eras[trreal$Eras>1825]<-1869
rtpoints<-group_by(rtreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
trpoints<-group_by(trreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
points<-as.data.frame(rbind(rtpoints,trpoints))
points$size<-cut(points$num,breaks=c(-1,49.5,1000),labels=c('Less than 50','50 or more'))
ggplot(mreal,aes(YoC,isTo))+
stat_smooth(method='loess',aes(colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
coord_cartesian(xlim=c(750,2050))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
points
rtreal$Eras[rtreal$Eras>1700&rtreal$Eras<=1800]<-1750
rtreal$Eras[rtreal$Eras>1800]<-1869
trreal$Eras[trreal$Eras>1700&trreal$Eras<=1800]<-1750
trreal$Eras[trreal$Eras>1800]<-1869
rtpoints<-group_by(rtreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
trpoints<-group_by(trreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
points<-as.data.frame(rbind(rtpoints,trpoints))
points$size<-cut(points$num,breaks=c(-1,49.5,1000),labels=c('Less than 50','50 or more'))
ggplot(mreal,aes(YoC,isTo))+
stat_smooth(method='loess',aes(colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
coord_cartesian(xlim=c(750,2050))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
rtpoints
post1700<-subset(rtreal,YoC>1700)
testpoints<-group_by(rtreal,YoC,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
summary(testpoints)
plot(testpoints$YoC,testpoints$prob)
testpoints<-group_by(post1700,YoC,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
plot(testpoints$YoC,testpoints$prob)
ggplot(testpoints,aes(YoC,prob,size=num))+geom_point()
rtreal$Eras<-cut(rtreal$YoC,breaks=c(800,2000,20),labels=c(810,1990,20))
rtreal$Eras<-cut(rtreal$YoC,breaks=c(800,2020,20),labels=c(810,2010,20))
rtreal$Eras<-cut(rtreal$YoC,breaks=seq(800,2000,20),labels=seq(810,1990,20))
summary(rtreal$Eras)
trreal$Eras<-cut(trreal$YoC,breaks=seq(800,2000,20),labels=seq(810,1990,20))
rtpoints<-group_by(rtreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
trpoints<-group_by(trreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
points<-as.data.frame(rbind(rtpoints,trpoints))
points$size<-cut(points$num,breaks=c(-1,49.5,1000),labels=c('Less than 50','50 or more'))
ggplot(mreal,aes(YoC,isTo))+
stat_smooth(method='loess',aes(colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
coord_cartesian(xlim=c(750,2050))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
rtreal$Eras<-as.numeric(as.character(cut(rtreal$YoC,breaks=seq(800,2000,20),labels=seq(810,1990,20))))
trreal$Eras<-as.numeric(as.character(cut(trreal$YoC,breaks=seq(800,2000,20),labels=seq(810,1990,20))))
rtpoints<-group_by(rtreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
trpoints<-group_by(trreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
points<-as.data.frame(rbind(rtpoints,trpoints))
points$size<-cut(points$num,breaks=c(-1,49.5,1000),labels=c('Less than 50','50 or more'))
# pdf('loessgraph.pdf',width=8,height=4)
ggplot(mreal,aes(YoC,isTo))+
stat_smooth(method='loess',aes(colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
coord_cartesian(xlim=c(750,2050))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
ggplot(mreal,aes(YoC,isTo))+
stat_smooth(method='loess')+geom_point(data=points,aes(Eras,prob,size=size))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
coord_cartesian(xlim=c(750,2050))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))+
facet_wrap(~Envir)
ggplot(mreal,aes(YoC,isTo))+
stat_smooth(method='glm',family='binomial')+geom_point(data=points,aes(Eras,prob,size=size))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
coord_cartesian(xlim=c(750,2050))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))+
facet_wrap(~Envir)
ggplot(subset(pred,variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
rtreal$Eras<-as.numeric(as.character(cut(rtreal$YoC,breaks=seq(800,2000,100),labels=seq(850,1950,100))))
trreal$Eras<-as.numeric(as.character(cut(trreal$YoC,breaks=seq(800,2000,100),labels=seq(850,1950,100))))
rtpoints<-group_by(rtreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
trpoints<-group_by(trreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
points<-as.data.frame(rbind(rtpoints,trpoints))
points$size<-cut(points$num,breaks=c(-1,49.5,1000),labels=c('Less than 50','50 or more'))
# pdf('loessgraph.pdf',width=8,height=4)
ggplot(mreal,aes(YoC,isTo))+
stat_smooth(method='glm',family='binomial')+geom_point(data=points,aes(Eras,prob,size=size))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
coord_cartesian(xlim=c(750,2050))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))+
facet_wrap(~Envir)
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
summary(mreal$YoC)
seq(860,1940,40)
rtreal$Eras<-as.numeric(as.character(cut(rtreal$YoC,breaks=seq(860,1940,40),labels=seq(880,1920,40))))
trreal$Eras<-as.numeric(as.character(cut(trreal$YoC,breaks=seq(860,1940,40),labels=seq(880,1920,40))))
rtpoints<-group_by(rtreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
trpoints<-group_by(trreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
points<-as.data.frame(rbind(rtpoints,trpoints))
points$size<-cut(points$num,breaks=c(-1,49.5,1000),labels=c('Less than 50','50 or more'))
# pdf('loessgraph.pdf',width=8,height=4)
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
rtpoints$Eras[rtpoints$Eras >= 1800]<- 1869
rtpoints<-group_by(rtreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
trpoints<-group_by(trreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
points<-as.data.frame(rbind(rtpoints,trpoints))
points$size<-cut(points$num,breaks=c(-1,49.5,1000),labels=c('Less than 50','50 or more'))
# pdf('loessgraph.pdf',width=8,height=4)
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
rtreal$Eras<-as.numeric(as.character(cut(rtreal$YoC,breaks=seq(860,1940,40),labels=seq(880,1920,40))))
trreal$Eras<-as.numeric(as.character(cut(trreal$YoC,breaks=seq(860,1940,40),labels=seq(880,1920,40))))
rtreal$Eras[rtreal$Eras >= 1800]<- 1869
rtpoints<-group_by(rtreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
trpoints<-group_by(trreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
points<-as.data.frame(rbind(rtpoints,trpoints))
points$size<-cut(points$num,breaks=c(-1,49.5,1000),labels=c('Less than 50','50 or more'))
# pdf('loessgraph.pdf',width=8,height=4)
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
summary(rtreal)
rtreal$Eras<-as.numeric(as.character(cut(rtreal$YoC,breaks=seq(860,1940,40),labels=seq(880,1920,40))))
summary(rtreal)
rtreal$Eras<-as.numeric(as.character(cut(rtreal$YoC,breaks=seq(859,1939,40),labels=seq(880,1920,40))))
trreal$Eras<-as.numeric(as.character(cut(trreal$YoC,breaks=seq(859,1939,40),labels=seq(880,1920,40))))
rtreal$Eras[rtreal$Eras >= 1800] <- 1869
summary(rtreal)
rtreal$Eras<-as.numeric(as.character(cut(rtreal$YoC,breaks=seq(859,1939,40),labels=seq(880,1920,40))))
trreal$Eras<-as.numeric(as.character(cut(trreal$YoC,breaks=seq(859,1939,40),labels=seq(880,1920,40))))
rtreal$Eras[rtreal$Eras >= 1800] <- 1869
rtpoints<-group_by(rtreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
trpoints<-group_by(trreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
points<-as.data.frame(rbind(rtpoints,trpoints))
points$size<-cut(points$num,breaks=c(-1,49.5,1000),labels=c('Less than 50','50 or more'))
# pdf('loessgraph.pdf',width=8,height=4)
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
rtreal$Eras<-as.numeric(as.character(cut(rtreal$YoC,breaks=seq(800,2000,50),labels=seq(825,1975,50))))
trreal$Eras<-as.numeric(as.character(cut(trreal$YoC,breaks=seq(800,2000,50),labels=seq(825,1975,50))))
rtreal$Eras[rtreal$Eras >= 1800] <- 1869
rtpoints<-group_by(rtreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
trpoints<-group_by(trreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
points<-as.data.frame(rbind(rtpoints,trpoints))
points$size<-cut(points$num,breaks=c(-1,49.5,1000),labels=c('Less than 50','50 or more'))
# pdf('loessgraph.pdf',width=8,height=4)
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
rtreal$Eras<-as.numeric(as.character(cut(rtreal$YoC,breaks=seq(800,2000,50),labels=seq(825,1975,50))))
trreal$Eras<-as.numeric(as.character(cut(trreal$YoC,breaks=seq(800,2000,50),labels=seq(825,1975,50))))
# rtreal$Eras[rtreal$Eras >= 1800] <- 1869
rtpoints<-group_by(rtreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
trpoints<-group_by(trreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
points<-as.data.frame(rbind(rtpoints,trpoints))
points$size<-cut(points$num,breaks=c(-1,49.5,1000),labels=c('Less than 50','50 or more'))
# pdf('loessgraph.pdf',width=8,height=4)
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
rtreal$Eras<-as.numeric(as.character(cut(rtreal$YoC,breaks=seq(800,2000,50),labels=seq(825,1975,50))))
trreal$Eras<-as.numeric(as.character(cut(trreal$YoC,breaks=seq(800,2000,50),labels=seq(825,1975,50))))
rtreal$Eras[rtreal$Eras >= 1800] <- 1869
rtpoints<-group_by(rtreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
trpoints<-group_by(trreal,Eras,Envir)%>%summarise(prob=sum(isTo)/sum(!is.na(isTo)),num=sum(!is.na(isTo)))
rtpoints
80*.213
18/80
16/80
15/80
?scale_shape
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_manual(name="Context",values=c('R','T'))+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_shape_manual(name="Context",values=c('R','T'))+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_shape_manual(name="Context",values=c('R','T'))+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_shape_manual(name="Context",values=c('R','T'))+scale_colour_manual(name="Context",values=c('darkgrey','black'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_shape_manual(name="Context",values=c('R','T'))+scale_linetype_discrete(name="Context")+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_shape_discrete(name="Context",values=c('R','T'))+scale_linetype_discrete(name="Context")+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_shape_manual(name="Context",values=c('R','T'))+scale_linetype_manual(name="Context")+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
?scale_linetype_manual
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_shape_manual(name="Context",values=c('R','T'))+scale_linetype_manual(name="Context",values=c('-','--'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_shape_manual(name="Context",values=c('R','T'))+scale_linetype_manual(name="Context",values=c('solid','dashed'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
ggplot(subset(pred,variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable,colour=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_shape_discrete(name="Context")+facet_wrap(~Envir)+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
ggplot(subset(pred,variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable))+geom_point(data=points,aes(Eras,prob,size=size))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
facet_wrap(~Envir)+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
ggplot(subset(pred,variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable))+geom_point(data=points,aes(Eras,prob,size=size))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
facet_wrap(~Envir)+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))+
theme(legend.position='bottom')
pdf('probgraph.pdf',width=8,height=4)
ggplot(subset(pred,variable%in%c('prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=Envir))+geom_point(data=points,aes(Eras,prob,size=size,shape=Envir))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_shape_manual(name="Context",values=c('R','T'))+scale_linetype_manual(name="Context",values=c('solid','dashed'))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
dev.off()
pdf('modelsgraph.pdf',width=12,height=4)
ggplot(subset(pred,variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable))+geom_point(data=points,aes(Eras,prob,size=size))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
facet_wrap(~Envir)+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))+
theme(legend.position='bottom')
dev.off()
ggplot(subset(data=subset(pred,Envir=='I gave (to) recipient theme'),variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable))+
geom_point(data=subset(points,Envir=='I gave (to) recipient theme'),aes(Eras,prob,size=size))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))+
theme(legend.position='bottom')
ggplot(subset(data=subset(pred,Envir=='I gave (to) recipient theme'),variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(aes(linetype=variable))+
geom_point(data=subset(points,Envir=='I gave (to) recipient theme'),aes(Eras,prob,size=size))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))+
theme(legend.position='bottom')
summary(pred)
summary(subset(pred,Envir=='I gave (to) recipient theme'))
summary(subset(points,Envir=='I gave (to) recipient theme'))
ggplot(subset(pred,variable%in%c('postma_fit_full','prob_fit_full')),aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(data=subset(pred,Envir=='I gave (to) recipient theme'),aes(linetype=variable))+
geom_point(data=subset(points,Envir=='I gave (to) recipient theme'),aes(Eras,prob,size=size))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))+
theme(legend.position='bottom')
ggplot(pred,aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(data=subset(pred,Envir=='I gave (to) recipient theme'&variable%in%c('postma_fit_full','prob_fit_full')),aes(linetype=variable))+
geom_point(data=subset(points,Envir=='I gave (to) recipient theme'),aes(Eras,prob,size=size))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))+
theme(legend.position='bottom')
ggplot(pred,aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(data=subset(pred,Envir=='I gave (to) recipient theme'&variable%in%c('postma_fit_full','prob_fit_full')),aes(linetype=variable))+
geom_point(data=subset(points,Envir=='I gave (to) recipient theme'),aes(Eras,prob,size=size))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
ggplot(pred,aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(data=subset(pred,Envir=='I gave (to) recipient theme'&variable%in%c('postma_fit_full','prob_fit_full')),aes(linetype=variable))+
geom_point(data=subset(points,Envir=='I gave (to) recipient theme'),aes(Eras,prob,size=size))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
coord_cartesian(ylim=c(-0.01,1.01))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
pdf('modelsgraph.pdf',width=12,height=4)
ggplot(pred,aes((x*sd(mreal$YoC))+mean(mreal$YoC),value))+
geom_line(data=subset(pred,Envir=='I gave (to) recipient theme'&variable%in%c('postma_fit_full','prob_fit_full')),aes(linetype=variable))+
geom_point(data=subset(points,Envir=='I gave (to) recipient theme'),aes(Eras,prob,size=size))+scale_size_manual(name='Token Number',values=c(2,4))+
scale_linetype_discrete(name="Model Type",labels=c("First Derivative","Probability Multiplication"))+
coord_cartesian(ylim=c(-0.01,1.01))+
scale_y_continuous(name="Percent to use",breaks=c(0,.2,.4,.5,.6,.8,1),labels=c('0%','20%','40%','50%','60%','80%','100%'))+
scale_x_continuous(name="Year of Composition",breaks=seq(800,2000,200),labels=seq(800,2000,200))
dev.off()
heavydf<-subset(mreal,YoC>1400&Envir=='I gave (to) recipient theme'&IO=='Recipient Noun'&DO=='Theme Noun')
levels(heavydf$AccSize)[levels(heavydf$AccSize)=="MORE"]="25"
heavydf$AccSize<-as.numeric(as.character(heavydf$AccSize))
fullmod<-glm(data=heavydf,isTo~YoC+AccSize+AccCP,family=binomial)
heavymod<-glm(data=heavydf,isTo~AccSize+AccCP,family=binomial)
nullmod<-glm(data=heavydf,isTo~1,family=binomial)
atab<-anova(heavymod,fullmod,test="LRT")
atab<-cbind(atab,AIC(heavymod,fullmod)[,2])
atab<-cbind(atab,BIC(heavymod,fullmod)[,2])
colnames(atab)[6]<-'AIC'
colnames(atab)[7]<-'BIC'
print(xtable(atab,caption='Model Comparison Using Log-likelihood Ratio Test, AIC and BIC \\label{tab:modcomp}',table.placement='!h'))
atab<-anova(nullmod,heavymod,fullmod,test="LRT")
atab<-cbind(atab,AIC(nullmod,heavymod,fullmod)[,2])
atab<-cbind(atab,BIC(nullmod,heavymod,fullmod)[,2])
colnames(atab)[6]<-'AIC'
colnames(atab)[7]<-'BIC'
xtable(atab,digits=0,caption='Model Comparison Using Log-likelihood Ratio Test, AIC and BIC \\label{tab:modcomp}',table.placement='!h')
xtable(atab,digits=2,caption='Model Comparison Using Log-likelihood Ratio Test, AIC and BIC \\label{tab:modcomp}',table.placement='!h')
atab
atab<-anova(prob_fit_null,prob_fit_orddiff,prob_fit_diffint,prob_fit_downdiff,prob_fit_full)
atab<-cbind(atab,AIC(prob_fit_null,prob_fit_orddiff,prob_fit_diffint,prob_fit_downdiff,prob_fit_full)[,1])
colnames(atab)[6]<-'AIC'
xtable(atab)
heavydf<-subset(mreal,YoC>1400&Envir=='I gave (to) recipient theme'&IO=='Recipient Noun'&DO=='Theme Noun')
levels(heavydf$AccSize)[levels(heavydf$AccSize)=="MORE"]="25"
heavydf$AccSize<-as.numeric(as.character(heavydf$AccSize))
fullmod<-glm(data=heavydf,isTo~YoC+AccSize+AccCP,family=binomial)
heavymod<-glm(data=heavydf,isTo~AccSize+AccCP,family=binomial)
nullmod<-glm(data=heavydf,isTo~1,family=binomial)
atab<-anova(nullmod,heavymod,fullmod,test="LRT")
atab<-cbind(atab,AIC(nullmod,heavymod,fullmod)[,2])
atab<-cbind(atab,BIC(nullmod,heavymod,fullmod)[,2])
colnames(atab)[6]<-'AIC'
colnames(atab)[7]<-'BIC'
rownames(atab)<-c('Only Heaviness of Theme','Year and Heaviness of Theme')
xtable(atab,digits=2,caption='Model Comparison Using Log-likelihood Ratio Test, AIC and BIC \\label{tab:modcomp}',table.placement='!h')
